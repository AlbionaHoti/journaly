# Migration `20200226081204-init`

This migration has been generated by Robin MacPherson at 2/26/2020, 8:12:04 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Status" AS ENUM ('ADMIN', 'MODERATOR', 'FREE_USER', 'PRO_USER');

CREATE TYPE "Permission" AS ENUM ('ADMIN', 'USER', 'POST_CREATE', 'POST_UPDATE', 'POST_DELETE', 'PERMISSION_UPDATE');

CREATE TABLE "public"."User" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "email" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "password" text  NOT NULL DEFAULT '',
    "permissions" "Permission"[]  ,
    "resetToken" text   ,
    "resetTokenExpiry" Decimal(65,30)   ,
    "status" "Status"[]  ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Post" (
    "author" text  NOT NULL ,
    "body" text  NOT NULL DEFAULT '',
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "image" text   ,
    "largeImage" text   ,
    "published" boolean  NOT NULL DEFAULT false,
    "title" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("author")REFERENCES "public"."User"("id") ON DELETE RESTRICT  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200226081204-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,41 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
+
+enum Status {
+  ADMIN MODERATOR FREE_USER PRO_USER
+}
+
+enum Permission {
+  ADMIN USER POST_CREATE POST_UPDATE POST_DELETE PERMISSION_UPDATE
+}
+
+model User {
+  id               String       @id @default(cuid())
+  name             String
+  email            String       @unique
+  password         String
+  resetToken       String?
+  resetTokenExpiry Float?
+  permissions      Permission[]
+  status           Status[]
+  createdAt        DateTime     @default(now())
+  updatedAt        DateTime     @updatedAt
+}
+
+model Post {
+  id         String   @id @default(cuid())
+  title      String
+  body       String
+  published  Boolean
+  image      String?
+  largeImage String?
+  createdAt  DateTime @default(now())
+  updatedAt  DateTime @updatedAt
+  author     User
+}
```
