# Migration `20200621180255-fix-post-model`

This migration has been generated by Robin MacPherson at 6/21/2020, 6:02:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Image" DROP CONSTRAINT IF EXiSTS "Image_postId_ImageToPost_fkey",
DROP COLUMN "postId_ImageToPost",
DROP COLUMN "postId",
ADD COLUMN "postId" integer   ;

ALTER TABLE "public"."Post" ALTER COLUMN "status" SET DEFAULT 'DRAFT';

ALTER TABLE "public"."User" ALTER COLUMN "userRole" SET DEFAULT 'FREE_USER';

ALTER TABLE "public"."Image" ADD FOREIGN KEY ("postId")REFERENCES "public"."Post"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200620202031-add-user-profile-image..20200621180255-fix-post-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -183,15 +183,14 @@
   comments           Comment[]
 }
 model Image {
-  id                 Int       @default(autoincrement()) @id
-  smallSize          String
-  largeSize          String
-  postId             String?
-  imageRole          ImageRole
-  Post               Post?     @relation(fields: [postId_ImageToPost], references: [id])
-  postId_ImageToPost Int?
+  id        Int       @default(autoincrement()) @id
+  smallSize String
+  largeSize String
+  imageRole ImageRole
+  Post      Post?     @relation(fields: [postId], references: [id])
+  postId    Int?
 }
 model Prompt {
   id      Int    @default(autoincrement()) @id
```
