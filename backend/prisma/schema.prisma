datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator prisma_client {
  provider = "prisma-client-js"
}

model User {
  id                String        @id @default(cuid())
  name              String
  email             String        @unique
  handle            String        @unique
  password          String
  userRole          UserRole      @default(FREE_USER)
  resetToken        String?
  resetTokenExpiry  Float?
  bio               String?
  posts             Post[]
  socialMedia       SocialMedia[]
  interests         Topic[]
  location          Location?
  languagesNative   Language[]    @relation("LanguageToNative")
  languagesLearning Language[]    @relation("LanguageToLearner")
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
}

model SocialMedia {
  id       String              @id @default(cuid())
  platform SocialMediaPlatform
  url      String
}

model Post {
  id         String     @id @default(cuid())
  title      String
  body       String
  status     PostStatus @default(DRAFT)
  images     Image[]
  largeImage String?
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  author     User
  readCount  Int        @default(0)
  readTime   Int        @default(1)
  likes      Like[]
  comments   Comment[]
  topic      Topic[]
  language   Language?
  // TEMPORARY
  longitude  Float?
  latitude   Float?
}

model Location {
  id      String @id @default(cuid())
  country String
  city    String
}

model Topic {
  id    String @id @default(cuid())
  name  String
  posts Post[]
}

model Like {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  author    User
  post      Post
}

model Comment {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  body      String
  author    User
  post      Post
  thread    Thread
}

model Thread {
  id       String   @id @default(cuid())
  position Int // starting index of thread
  comments Comment[]
}

model Interest {
  id    String @id @default(cuid())
  name  String
  posts Post[]
}

model Language {
  id            String  @id @default(cuid())
  posts         Post[]
  name          String
  dialect       String?
  nativeUsers   User[]  @relation("LanguageToNative")
  learningUsers User[]  @relation("LanguageToLearner")
}

model Image {
  id        String  @id @default(cuid())
  smallSize String
  largeSize String
}

enum UserRole {
  ADMIN MODERATOR FREE_USER PRO_USER
}

enum PostStatus {
  DRAFT PUBLISHED
}

enum SocialMediaPlatform {
  FACEBOOK YOUTUBE INSTAGRAM LINKEDIN
}
