# Migration `20200923094139-add-user-follows-m2m`

This migration has been generated by Robin MacPherson at 9/23/2020, 9:41:39 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_UserFollows" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

ALTER TABLE "public"."Post" ALTER COLUMN "status" SET DEFAULT 'DRAFT';

ALTER TABLE "public"."User" ALTER COLUMN "userRole" SET DEFAULT 'FREE_USER';

CREATE UNIQUE INDEX "_UserFollows_AB_unique" ON "public"."_UserFollows"("A","B")

CREATE  INDEX "_UserFollows_B_index" ON "public"."_UserFollows"("B")

ALTER TABLE "public"."_UserFollows" ADD FOREIGN KEY ("A")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_UserFollows" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200919143307-update-reset-token-expiry-type..20200923094139-add-user-follows-m2m
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -32,8 +32,10 @@
   commentThanks       CommentThanks[]
   postCommentThanks   PostCommentThanks[]
   comments            Comment[]
   postComments        PostComment[]
+  followedBy          User[]               @relation("UserFollows", references: [id])
+  following           User[]               @relation("UserFollows", references: [id])
 }
 model Auth {
   id               Int     @default(autoincrement()) @id
```


